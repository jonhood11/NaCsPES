function out = NaCs3W1PES(r)
%Input Bohr, output Hartree

%From [1] A. Grochola et al., Phys. Rev. A 84, 012507 (2011).

%Convert input Bohr to Angstrom
r = r*0.529177211;

out = arrayfun(@(x) NaCs3W1PES_single(x), r);
% out = out - 16686.547; %Set potential to 0 at infinity

%Set potential of S+S Na+Cs asymptote to be 0
out = out - 4954.24;

%Convert cm^-1 to Hartree
out = out/219474.631;

end

function out = NaCs3W1PES_single(in)
%Input angstrom, output cm^-1

r = [2.4 2.6 2.8 3.0 3.2 3.4 3.6 3.8 4.0 4.2 4.4 4.6 4.8 5.0 5.2 5.4 5.6 ...
    5.8 6.0 6.2 6.4 6.6 6.8 7.0 7.2 7.4 7.6 7.8 8.0 8.2 8.4 8.6 8.8 9.2 ...
    9.6 10.4 11.2 12.0 12.8 14.4 16.0 17.6 20.0 22.0 25.0];

U = [29727.2633 24990.4728 21864.2749 19683.9887 18124.4018 16830.7370 ...
    16124.0709 15737.4482 15242.0798 14882.2724 14653.4028 14568.7429 ...
    14558.4133 14618.7808 14705.5185 14812.0455 14937.3480 15077.0980 ...
    15226.6600 15388.4238 15561.1169 15738.3493 15908.8198 16036.9412 ...
    16133.2912 16208.9728 16271.9689 16325.4945 16374.4334 16417.0169 ...
    16453.6268 16489.0947 16518.6541 16563.2505 16593.7972 16633.5845 ...
    16653.6696 16665.7349 16672.9646 16680.2626 16683.4237 16684.7813 ...
    16685.6947 16686.2827 16686.1716];

V = @(x) 16686.547 - 2.66558e7./x.^6 - 8.17195e9./x.^8 + 4.50611e11./x.^10;

if in < 13.02151
    out = interp1(r, U, in, 'pchip');
else
    out = V(in);
end

end
