function out = NaCsBPES(r)
%Input Bohr, output Hartree

%From [1] A. Grochola, P. Kowalczyk, and W. Jastrzebski, Chem. Phys. Lett. 497, 22 (2010).

%Convert input Bohr to Angstrom
r = r*0.529177211;

out = arrayfun(@(x) NaCsBPES_single(x), r);
% out = out - 16686.547; %Set potential to 0 at infinity
%Set potential of S+S Na+Cs asymptote to be 0
out = out - 4954.24;

%Convert cm^-1 to Hartree
out = out/219474.631;

end

function out = NaCsBPES_single(in)
%Input angstrom, output cm^-1

% data from table 1
% d = [...
%     3.4 28303.3752 7.6 16404.7489
%     3.6 19755.5597 8.0 16456.2907
%     3.7 17921.4827 8.8 16538.1047
%     3.8 16463.3209 9.6 16589.8797
%     3.9 15787.6419 10.0 16624.5842
%     4.0 15580.2126 11.2 16645.6826
%     4.2 15417.0134 12.0 16660.1290
%     4.4 15370.0231 12.8 16668.6771
%     4.6 15394.9854 14.4 16677.7711
%     4.8 15463.8153 16.0 16682.0108
%     5.2 15649.2462 17.6 16684.0715
%     5.6 15824.2158 19.2 16685.1259
%     6.0 15981.0697 20.8 16685.6952
%     6.4 16121.4339 22.4 16686.0165
%     6.8 16239.3309 24.8 16686.2696];
% 
% r = [d(:,1); 7.2; d(:,3)];
% U = [d(:,2); 16332.8827; d(:,4)];

r = [3.4000
    3.6000
    3.7000
    3.8000
    3.9000
    4.0000
    4.2000
    4.4000
    4.6000
    4.8000
    5.2000
    5.6000
    6.0000
    6.4000
    6.8000
    7.2000
    7.6000
    8.0000
    8.8000
    9.6000
   10.0000
   11.2000
   12.0000
   12.8000
   14.4000
   16.0000
   17.6000
   19.2000
   20.8000
   22.4000
   24.8000];

U = 1.0e+04 *[2.830337520000000
   1.975555970000000
   1.792148270000000
   1.646332090000000
   1.578764190000000
   1.558021260000000
   1.541701340000000
   1.537002310000000
   1.539498540000000
   1.546381530000000
   1.564924620000000
   1.582421580000000
   1.598106970000000
   1.612143390000000
   1.623933090000000
   1.633288270000000
   1.640474890000000
   1.645629070000000
   1.653810470000000
   1.658987970000000
   1.662458420000000
   1.664568260000000
   1.666012900000000
   1.666867710000000
   1.667777110000000
   1.668201080000000
   1.668407150000000
   1.668512590000000
   1.668569520000000
   1.668601650000000
   1.668626960000000];


V = @(x) 16686.547 - 5.16831e7./x.^6 - 9.42143e9./x.^8 + 8.18828e11./x.^10;

if in < 13.18506
    out = interp1(r, U, in, 'pchip');
else
    out = V(in);
end

end
